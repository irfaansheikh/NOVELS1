function Browser_Info(){this.detect_string = navigator.userAgent.toLowerCase();this.os = null;this.name = null;this.version = null;this.full_version = null;this.name_index = -1;this.name_string = '';};Browser_Info.prototype.get_Browser_Object = function(){var browser_obj = new Object();browser_obj.name = this.get_Name();browser_obj.version = this.get_Version();browser_obj.full_version = this.get_Full_Version();browser_obj.os = this.get_Os();return browser_obj;};Browser_Info.prototype.get_Name = function(){if(this.name == null){switch (true){case this._check_Browser_String('konqueror', 'name'):this.name = 'Konqueror';break;case this._check_Browser_String('safari', 'name'):this.name = 'Safari';break;case this._check_Browser_String('firefox', 'name'):this.name = 'Firefox';break;case this._check_Browser_String('omniweb', 'name'):this.name = 'OmniWeb';break;case this._check_Browser_String('opera', 'name'):this.name = 'Opera';break;case this._check_Browser_String('webtv', 'name'):this.name = 'WebTV';break;case this._check_Browser_String('icab', 'name'):this.name = 'iCab';break;case this._check_Browser_String('msie', 'name'):this.name = 'Internet Explorer';break;case !this._check_Browser_String('compatible', 'name'):this.name = 'Netscape Navigator';break;default:this.name = 'An unknown browser';break;}}return this.name;};Browser_Info.prototype.get_Version = function(){var allowed_chars = '0123456789.';if(this.version == null){this.get_Name();if(this.name == 'Netscape Navigator'){var version_string = this.detect_string.substr(8);}else{var version_string = this.detect_string.substr(this.name_index + this.name_string.length);}var ver_str_length = version_string.length;var end_index = ver_str_length;for(var i = 0; i < ver_str_length; i++){var char_split = allowed_chars.split(version_string.charAt(i));if(char_split.length == 1){end_index = i;break;}}this.full_version = version_string.substring(0, end_index);this.version = this.full_version.substring(0, this.full_version.indexOf('.'));if(this.version < 1){this.version = this.full_version;}}return this.version;};Browser_Info.prototype.get_Full_Version = function(){if(this.full_version == null){this.get_Version();}return this.full_version;};Browser_Info.prototype.get_Os = function(){if(this.os == null){switch(true){case this._check_Browser_String('linux'):this.os = 'Linux';break;case this._check_Browser_String('x11'):this.os = 'Unix';break;case this._check_Browser_String('mac'):this.os = 'Mac';break;case this._check_Browser_String('win'):this.os = 'Windows';break;default:this.os = 'an unknown operating system';break;}}return this.os;};Browser_Info.prototype._check_Browser_String = function(needle, type){var found = false;var place_index = this.detect_string.indexOf(needle);if(place_index > -1){found = true;}switch(type){case 'name':this.name_index = place_index + 1;this.name_string = needle;break;default:break;}return found;};function Ad_Serve(affid, ad_data, style_func, debug_level, dev_stage, js_debug_inst){this.debug_level = (debug_level > 1) ? debug_level : 0;this.debug = (this.debug_level > 1) ? true: false;this.dev_stage = (dev_stage) ? dev_stage : 'live';if(js_debug_inst && this.debug){this.js_debug = js_debug_inst;}else if(this.debug){try{this.js_debug = new Js_Debug(this.debug_level, this.dev_stage);}catch(e){this.debug = false;alert('Ad Serve: Debug is turned on, but Js_Debug class is not available.\n\nTurning debug off.');}}try{this.browser = new Browser_Info();}catch(e){this.browser = null;}this.ads_written = false;if(style_func != null){try{eval(style_func + "(ad_data, this); ");this.ads_written = true;}catch(e){this._debug_out(e, 'error');}}else{try{this.output_Ad(ad_data, this);this.ads_written = true;}catch(e){this._debug_out(e, 'error');}}if(this.ads_written){this.call_Valid(affid);}};Ad_Serve.prototype.call_Valid = function(affid){try{var js_scr = document.createElement('SCRIPT');js_scr.type = 'text/javascript';js_scr.src = 'http://feed.validclick.com/check.php?affid=' + affid;if(this.browser.get_Name() == 'Internet Explorer'){document.body.insertAdjacentElement('afterBegin', js_scr);}else{document.body.appendChild(js_scr);}}catch(e){this._debug_out(e, 'error');}};Ad_Serve.prototype.style_Truncate = function(content, words){if(words == null){words = 6;}var content_words = content.split(' ');if(content_words.length > words){content_words = content_words.slice(0, words);content = content_words.join(' ');}var found_punc = content.lastIndexOf('.') + 1;if(found_punc > 0){content = content.substring(0, found_punc);}return content;};Ad_Serve.prototype.style_Filter_Domain = function(ad_source, max_count, domain){var ads = new Array();max_count = Math.min(ad_source.length, max_count);var domain_array = new Array();if(domain.indexOf(',') > 0){domain_array = domain.split(',');}else{domain_array[1] = domain;}for(a = 0; a < ad_source.length; a++){var ad_okay = true;for(d = 0; d < domain_array.length; d++){if(ad_source[a].link.indexOf(domain_array[d]) > 0){ad_okay = false;break;}}if(ad_okay){ads[ads.length] = ad_source[a];if(ads.length == max_count){break;}}}return ads;};Ad_Serve.prototype._debug_out = function(msg, type){if(this.debug){this.js_debug.debug_Out('Ad Serve', msg, type);}};